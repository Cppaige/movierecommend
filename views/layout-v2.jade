doctype html
html(lang="zh-CN")
  head
    title= title || 'MovieMatrix - 智能电影推荐'
    meta(charset='utf-8')
    meta(name='viewport', content='width=device-width, initial-scale=1.0')

    // 通用基础样式（所有页面共享）
    link(rel='stylesheet', href='/css/common.css')
    link(rel='stylesheet', href='/css/page-common.css')
    link(rel='stylesheet', href='/css/apple-theme.css')
    link(rel='stylesheet', href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css')

    // 允许子页面添加自己的CSS
    block extraCSS

  body(data-is-login=isLogin ? 'true' : 'false')
    // 导航栏
    header#header
      .nav-container
        a.logo(href='/')
          i.fas.fa-film
          span MovieMatrix

        nav.main-nav
          ul
            li: a(href='/') 首页
            li: a(href='/movielibrary') 电影库
            if isLogin
              li: a(href='/favorites')
                i.fas.fa-heart
                | 我的收藏
              li: a(href='/myratings') 我的评分
              li: a(href='/select-movies')
                i.fas.fa-star
                | 去评分

        .auth-buttons
          if isLogin
            .user-info
              span.welcome
                i.fas.fa-user-circle
                | #{username}
              a.btn.btn-logout(href='/logout') 退出
          else
            a.btn.btn-login(href='/loginpage') 登录
            a.btn.btn-signup(href='/registerpage') 注册

    // 主要内容区域
    main#main-content
      block content

    // 页脚
    footer#footer
      .footer-container
        .footer-brand
          .logo
            i.fas.fa-film
            span MovieMatrix
          p.tagline 发现你的下一部好电影

        .footer-links
          .link-group
            h4 快速链接
            a(href='/') 首页
            a(href='/movielibrary') 电影库
            if isLogin
              a(href='/favorites') 我的收藏
              a(href='/myratings') 我的评分

          .link-group
            h4 帮助
            a(href='#') 使用指南
            a(href='#') 常见问题
            a(href='#') 联系我们

          .link-group
            h4 关于
            a(href='#') 关于我们
            a(href='#') 隐私政策
            a(href='#') 服务条款

        .footer-bottom
          p.copyright &copy; 2024 MovieMatrix. All rights reserved.

    // 全局JS
    script.
      // 暴露后端状态给JS
      window.appState = {
        isLogin: !{JSON.stringify(isLogin || false)},
        userId: !{JSON.stringify(userid || '')},
        userName: !{JSON.stringify(username || '')},
        ratedMovies: !{JSON.stringify(ratedMovies || [])}
      };

    // 允许子页面添加JS
    block extraJS
